-- Create suppliers table structure for MantisNXT\n-- Compatible with existing supplier API and form structure\n\n-- Main suppliers table\nCREATE TABLE IF NOT EXISTS suppliers (\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    name VARCHAR(255) NOT NULL,\n    code VARCHAR(50) UNIQUE NOT NULL,\n    legal_name VARCHAR(255) NOT NULL,\n    website VARCHAR(500),\n    industry VARCHAR(100),\n    tier VARCHAR(20) CHECK (tier IN ('strategic', 'preferred', 'approved', 'conditional')),\n    status VARCHAR(20) CHECK (status IN ('active', 'inactive', 'pending', 'suspended')),\n    category VARCHAR(100),\n    subcategory VARCHAR(100),\n    tags TEXT[], -- PostgreSQL array for tags\n    \n    -- Business information\n    tax_id VARCHAR(50),\n    registration_number VARCHAR(50),\n    founded_year INTEGER,\n    employee_count INTEGER,\n    annual_revenue DECIMAL(15, 2),\n    currency VARCHAR(3) DEFAULT 'ZAR',\n    \n    -- Capabilities\n    products TEXT[], -- PostgreSQL array for products\n    services TEXT[], -- PostgreSQL array for services\n    certifications TEXT[], -- PostgreSQL array for certifications\n    lead_time INTEGER DEFAULT 7, -- in days\n    minimum_order_value DECIMAL(15, 2),\n    payment_terms VARCHAR(50) DEFAULT 'Net 30',\n    \n    -- Additional fields for compatibility\n    email VARCHAR(255),\n    phone VARCHAR(50),\n    address TEXT,\n    contact_person VARCHAR(255),\n    geographic_region VARCHAR(100),\n    preferred_supplier BOOLEAN DEFAULT false,\n    bee_level VARCHAR(10), -- BEE level for South African context\n    local_content_percentage DECIMAL(5, 2), -- percentage\n    spend_last_12_months DECIMAL(15, 2) DEFAULT 0,\n    performance_tier VARCHAR(20) DEFAULT 'unrated',\n    \n    -- Audit fields\n    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n    created_by VARCHAR(255),\n    updated_by VARCHAR(255),\n    \n    -- Notes\n    notes TEXT\n);\n\n-- Supplier contacts table\nCREATE TABLE IF NOT EXISTS supplier_contacts (\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    supplier_id UUID NOT NULL REFERENCES suppliers(id) ON DELETE CASCADE,\n    type VARCHAR(20) CHECK (type IN ('primary', 'billing', 'technical', 'sales', 'support')),\n    name VARCHAR(255) NOT NULL,\n    title VARCHAR(100),\n    email VARCHAR(255),\n    phone VARCHAR(50),\n    mobile VARCHAR(50),\n    department VARCHAR(100),\n    is_primary BOOLEAN DEFAULT false,\n    is_active BOOLEAN DEFAULT true,\n    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Supplier addresses table\nCREATE TABLE IF NOT EXISTS supplier_addresses (\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    supplier_id UUID NOT NULL REFERENCES suppliers(id) ON DELETE CASCADE,\n    type VARCHAR(20) CHECK (type IN ('headquarters', 'billing', 'shipping', 'warehouse', 'manufacturing')),\n    name VARCHAR(100),\n    address_line1 VARCHAR(255) NOT NULL,\n    address_line2 VARCHAR(255),\n    city VARCHAR(100) NOT NULL,\n    state VARCHAR(100) NOT NULL,\n    postal_code VARCHAR(20) NOT NULL,\n    country VARCHAR(100) NOT NULL,\n    is_primary BOOLEAN DEFAULT false,\n    is_active BOOLEAN DEFAULT true,\n    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Supplier performance table\nCREATE TABLE IF NOT EXISTS supplier_performance (\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    supplier_id UUID NOT NULL REFERENCES suppliers(id) ON DELETE CASCADE,\n    \n    -- Overall ratings\n    overall_rating DECIMAL(3, 2) DEFAULT 0, -- 0-5 scale\n    quality_rating DECIMAL(3, 2) DEFAULT 0,\n    delivery_rating DECIMAL(3, 2) DEFAULT 0,\n    service_rating DECIMAL(3, 2) DEFAULT 0,\n    price_rating DECIMAL(3, 2) DEFAULT 0,\n    \n    -- Delivery metrics\n    on_time_delivery_rate DECIMAL(5, 2) DEFAULT 0, -- percentage\n    average_delivery_days DECIMAL(5, 2) DEFAULT 0,\n    total_deliveries INTEGER DEFAULT 0,\n    late_deliveries INTEGER DEFAULT 0,\n    \n    -- Quality metrics\n    quality_acceptance_rate DECIMAL(5, 2) DEFAULT 0, -- percentage\n    defect_rate DECIMAL(5, 2) DEFAULT 0,\n    return_rate DECIMAL(5, 2) DEFAULT 0,\n    quality_issues INTEGER DEFAULT 0,\n    \n    -- Financial metrics\n    total_purchase_value DECIMAL(15, 2) DEFAULT 0,\n    average_order_value DECIMAL(15, 2) DEFAULT 0,\n    discount_rate DECIMAL(5, 2) DEFAULT 0,\n    \n    -- Relationship metrics\n    responsiveness_rating DECIMAL(3, 2) DEFAULT 0, -- 0-10 scale\n    communication_rating DECIMAL(3, 2) DEFAULT 0,\n    innovation_rating DECIMAL(3, 2) DEFAULT 0,\n    sustainability_rating DECIMAL(3, 2) DEFAULT 0,\n    \n    -- Response time in hours\n    response_time DECIMAL(8, 2) DEFAULT 0,\n    lead_time_variance DECIMAL(5, 2) DEFAULT 0, -- percentage\n    \n    last_evaluation_date TIMESTAMP WITH TIME ZONE,\n    next_evaluation_date TIMESTAMP WITH TIME ZONE,\n    \n    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Supplier contracts table\nCREATE TABLE IF NOT EXISTS supplier_contracts (\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    supplier_id UUID NOT NULL REFERENCES suppliers(id) ON DELETE CASCADE,\n    contract_number VARCHAR(100) UNIQUE NOT NULL,\n    \n    -- Contract details\n    type VARCHAR(50) CHECK (type IN ('master_agreement', 'service_agreement', 'purchase_agreement', 'nda', 'framework', 'other')),\n    title VARCHAR(255) NOT NULL,\n    description TEXT,\n    \n    -- Dates\n    start_date DATE NOT NULL,\n    end_date DATE NOT NULL,\n    signed_date DATE,\n    renewal_date DATE,\n    \n    -- Status\n    status VARCHAR(20) CHECK (status IN ('draft', 'review', 'negotiation', 'approved', 'signed', 'active', 'expired', 'terminated')),\n    \n    -- Terms\n    auto_renewal BOOLEAN DEFAULT false,\n    renewal_period INTEGER, -- months\n    termination_notice INTEGER, -- days\n    \n    -- Financial\n    value DECIMAL(15, 2),\n    currency VARCHAR(3),\n    payment_terms VARCHAR(100),\n    \n    -- Stakeholders\n    our_signatory VARCHAR(255),\n    supplier_signatory VARCHAR(255),\n    \n    -- Audit\n    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n    updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n    created_by VARCHAR(255),\n    notes TEXT\n);\n\n-- Supplier documents table\nCREATE TABLE IF NOT EXISTS supplier_documents (\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    supplier_id UUID NOT NULL REFERENCES suppliers(id) ON DELETE CASCADE,\n    contract_id UUID REFERENCES supplier_contracts(id) ON DELETE SET NULL,\n    \n    name VARCHAR(255) NOT NULL,\n    type VARCHAR(50) CHECK (type IN ('contract', 'amendment', 'schedule', 'attachment', 'certificate', 'other')),\n    version VARCHAR(20),\n    file_url VARCHAR(500),\n    file_size BIGINT,\n    mime_type VARCHAR(100),\n    \n    upload_date TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n    uploaded_by VARCHAR(255),\n    is_active BOOLEAN DEFAULT true,\n    \n    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Supplier communications table\nCREATE TABLE IF NOT EXISTS supplier_communications (\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    supplier_id UUID NOT NULL REFERENCES suppliers(id) ON DELETE CASCADE,\n    \n    -- Communication details\n    type VARCHAR(20) CHECK (type IN ('email', 'phone', 'meeting', 'note', 'system')),\n    subject VARCHAR(255) NOT NULL,\n    content TEXT,\n    direction VARCHAR(10) CHECK (direction IN ('inbound', 'outbound')),\n    \n    -- Classification\n    category VARCHAR(50) CHECK (category IN ('general', 'order', 'quality', 'delivery', 'payment', 'contract', 'support')),\n    priority VARCHAR(10) CHECK (priority IN ('low', 'medium', 'high', 'urgent')),\n    \n    -- Follow-up\n    requires_follow_up BOOLEAN DEFAULT false,\n    follow_up_date TIMESTAMP WITH TIME ZONE,\n    follow_up_assignee VARCHAR(255),\n    \n    -- Audit\n    created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n    created_by VARCHAR(255),\n    is_archived BOOLEAN DEFAULT false,\n    tags TEXT[]\n);\n\n-- Create indexes for better performance\nCREATE INDEX IF NOT EXISTS idx_suppliers_name ON suppliers(name);\nCREATE INDEX IF NOT EXISTS idx_suppliers_code ON suppliers(code);\nCREATE INDEX IF NOT EXISTS idx_suppliers_status ON suppliers(status);\nCREATE INDEX IF NOT EXISTS idx_suppliers_tier ON suppliers(tier);\nCREATE INDEX IF NOT EXISTS idx_suppliers_category ON suppliers(category);\nCREATE INDEX IF NOT EXISTS idx_suppliers_industry ON suppliers(industry);\nCREATE INDEX IF NOT EXISTS idx_suppliers_tags ON suppliers USING GIN(tags);\nCREATE INDEX IF NOT EXISTS idx_suppliers_created_at ON suppliers(created_at);\n\nCREATE INDEX IF NOT EXISTS idx_supplier_contacts_supplier_id ON supplier_contacts(supplier_id);\nCREATE INDEX IF NOT EXISTS idx_supplier_contacts_is_primary ON supplier_contacts(is_primary);\n\nCREATE INDEX IF NOT EXISTS idx_supplier_addresses_supplier_id ON supplier_addresses(supplier_id);\nCREATE INDEX IF NOT EXISTS idx_supplier_addresses_is_primary ON supplier_addresses(is_primary);\n\nCREATE INDEX IF NOT EXISTS idx_supplier_performance_supplier_id ON supplier_performance(supplier_id);\nCREATE INDEX IF NOT EXISTS idx_supplier_performance_overall_rating ON supplier_performance(overall_rating);\n\nCREATE INDEX IF NOT EXISTS idx_supplier_contracts_supplier_id ON supplier_contracts(supplier_id);\nCREATE INDEX IF NOT EXISTS idx_supplier_contracts_status ON supplier_contracts(status);\nCREATE INDEX IF NOT EXISTS idx_supplier_contracts_end_date ON supplier_contracts(end_date);\n\nCREATE INDEX IF NOT EXISTS idx_supplier_documents_supplier_id ON supplier_documents(supplier_id);\nCREATE INDEX IF NOT EXISTS idx_supplier_communications_supplier_id ON supplier_communications(supplier_id);\n\n-- Create trigger to update updated_at timestamp\nCREATE OR REPLACE FUNCTION update_updated_at_column()\nRETURNS TRIGGER AS $$\nBEGIN\n    NEW.updated_at = NOW();\n    RETURN NEW;\nEND;\n$$ language 'plpgsql';\n\nCREATE TRIGGER update_suppliers_updated_at BEFORE UPDATE ON suppliers\n    FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();\n\nCREATE TRIGGER update_supplier_contacts_updated_at BEFORE UPDATE ON supplier_contacts\n    FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();\n\nCREATE TRIGGER update_supplier_addresses_updated_at BEFORE UPDATE ON supplier_addresses\n    FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();\n\nCREATE TRIGGER update_supplier_performance_updated_at BEFORE UPDATE ON supplier_performance\n    FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();\n\nCREATE TRIGGER update_supplier_contracts_updated_at BEFORE UPDATE ON supplier_contracts\n    FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();\n\n-- Insert sample data for testing\nINSERT INTO suppliers (\n    name, code, legal_name, website, industry, tier, status, category,\n    tax_id, registration_number, currency, payment_terms, email, phone,\n    address, contact_person, tags, products, services, lead_time,\n    geographic_region, preferred_supplier, bee_level, local_content_percentage\n) VALUES \n(\n    'Dell Technologies SA', 'DELL_001', 'Dell Technologies (Pty) Ltd',\n    'https://dell.co.za', 'Technology', 'strategic', 'active', 'Technology',\n    '9876543210', '2001/123456/07', 'ZAR', 'Net 30', 'procurement@dell.co.za',\n    '+27 11 709 7000', '1 Discovery Place, Sandton, 2196', 'Sarah Johnson',\n    ARRAY['technology', 'hardware', 'enterprise'], \n    ARRAY['laptops', 'desktops', 'servers', 'workstations'],\n    ARRAY['hardware_support', 'warranty', 'installation'], 5,\n    'Gauteng', true, 'Level 4', 85.5\n),\n(\n    'SAB Holdings', 'SAB_001', 'South African Breweries (Pty) Ltd',\n    'https://sab.co.za', 'Manufacturing', 'preferred', 'active', 'Manufacturing',\n    '1234567890', '1895/000123/07', 'ZAR', 'Net 45', 'procurement@sab.co.za',\n    '+27 11 407 1700', '65 Park Lane, Sandton, 2196', 'John Smith',\n    ARRAY['manufacturing', 'beverages', 'local'], \n    ARRAY['beverages', 'packaging', 'logistics'],\n    ARRAY['production', 'quality_control', 'distribution'], 14,\n    'Gauteng', true, 'Level 2', 95.0\n),\n(\n    'Vodacom Business', 'VDC_001', 'Vodacom (Pty) Ltd',\n    'https://vodacom.co.za', 'Telecommunications', 'strategic', 'active', 'Services',\n    '5555666777', '1993/005678/07', 'ZAR', 'Net 30', 'business@vodacom.co.za',\n    '+27 82 135 9000', 'Vodacom Corporate Park, Midrand, 1685', 'Lisa Williams',\n    ARRAY['telecommunications', 'connectivity', 'digital'], \n    ARRAY['mobile_services', 'internet', 'cloud_services'],\n    ARRAY['connectivity', 'support', 'consulting'], 3,\n    'Gauteng', true, 'Level 1', 88.0\n)\nON CONFLICT (code) DO NOTHING;\n\n-- Insert corresponding contacts\nWITH supplier_ids AS (\n    SELECT id, code FROM suppliers WHERE code IN ('DELL_001', 'SAB_001', 'VDC_001')\n)\nINSERT INTO supplier_contacts (\n    supplier_id, type, name, title, email, phone, department, is_primary, is_active\n)\nSELECT \n    s.id, 'primary', \n    CASE \n        WHEN s.code = 'DELL_001' THEN 'Sarah Johnson'\n        WHEN s.code = 'SAB_001' THEN 'John Smith'\n        WHEN s.code = 'VDC_001' THEN 'Lisa Williams'\n    END,\n    CASE \n        WHEN s.code = 'DELL_001' THEN 'Account Manager'\n        WHEN s.code = 'SAB_001' THEN 'Procurement Manager'\n        WHEN s.code = 'VDC_001' THEN 'Business Development Manager'\n    END,\n    CASE \n        WHEN s.code = 'DELL_001' THEN 'sarah.johnson@dell.co.za'\n        WHEN s.code = 'SAB_001' THEN 'john.smith@sab.co.za'\n        WHEN s.code = 'VDC_001' THEN 'lisa.williams@vodacom.co.za'\n    END,\n    CASE \n        WHEN s.code = 'DELL_001' THEN '+27 11 709 7001'\n        WHEN s.code = 'SAB_001' THEN '+27 11 407 1701'\n        WHEN s.code = 'VDC_001' THEN '+27 82 135 9001'\n    END,\n    'Sales', true, true\nFROM supplier_ids s;\n\n-- Insert corresponding addresses\nWITH supplier_ids AS (\n    SELECT id, code FROM suppliers WHERE code IN ('DELL_001', 'SAB_001', 'VDC_001')\n)\nINSERT INTO supplier_addresses (\n    supplier_id, type, address_line1, city, state, postal_code, country, is_primary, is_active\n)\nSELECT \n    s.id, 'headquarters',\n    CASE \n        WHEN s.code = 'DELL_001' THEN '1 Discovery Place'\n        WHEN s.code = 'SAB_001' THEN '65 Park Lane'\n        WHEN s.code = 'VDC_001' THEN 'Vodacom Corporate Park'\n    END,\n    CASE \n        WHEN s.code = 'DELL_001' THEN 'Sandton'\n        WHEN s.code = 'SAB_001' THEN 'Sandton'\n        WHEN s.code = 'VDC_001' THEN 'Midrand'\n    END,\n    'Gauteng',\n    CASE \n        WHEN s.code = 'DELL_001' THEN '2196'\n        WHEN s.code = 'SAB_001' THEN '2196'\n        WHEN s.code = 'VDC_001' THEN '1685'\n    END,\n    'South Africa', true, true\nFROM supplier_ids s;\n\n-- Insert performance data\nWITH supplier_ids AS (\n    SELECT id, code FROM suppliers WHERE code IN ('DELL_001', 'SAB_001', 'VDC_001')\n)\nINSERT INTO supplier_performance (\n    supplier_id, overall_rating, quality_rating, delivery_rating, service_rating, price_rating,\n    on_time_delivery_rate, average_delivery_days, total_deliveries, late_deliveries,\n    quality_acceptance_rate, defect_rate, return_rate, quality_issues,\n    total_purchase_value, average_order_value, discount_rate,\n    responsiveness_rating, communication_rating, innovation_rating, sustainability_rating,\n    response_time, lead_time_variance\n)\nSELECT \n    s.id,\n    CASE \n        WHEN s.code = 'DELL_001' THEN 4.8\n        WHEN s.code = 'SAB_001' THEN 4.5\n        WHEN s.code = 'VDC_001' THEN 4.7\n    END, -- overall_rating\n    CASE \n        WHEN s.code = 'DELL_001' THEN 4.9\n        WHEN s.code = 'SAB_001' THEN 4.3\n        WHEN s.code = 'VDC_001' THEN 4.6\n    END, -- quality_rating\n    CASE \n        WHEN s.code = 'DELL_001' THEN 4.7\n        WHEN s.code = 'SAB_001' THEN 4.8\n        WHEN s.code = 'VDC_001' THEN 4.9\n    END, -- delivery_rating\n    CASE \n        WHEN s.code = 'DELL_001' THEN 4.8\n        WHEN s.code = 'SAB_001' THEN 4.4\n        WHEN s.code = 'VDC_001' THEN 4.5\n    END, -- service_rating\n    CASE \n        WHEN s.code = 'DELL_001' THEN 4.6\n        WHEN s.code = 'SAB_001' THEN 4.7\n        WHEN s.code = 'VDC_001' THEN 4.8\n    END, -- price_rating\n    CASE \n        WHEN s.code = 'DELL_001' THEN 95.8\n        WHEN s.code = 'SAB_001' THEN 92.5\n        WHEN s.code = 'VDC_001' THEN 98.2\n    END, -- on_time_delivery_rate\n    CASE \n        WHEN s.code = 'DELL_001' THEN 3.2\n        WHEN s.code = 'SAB_001' THEN 8.5\n        WHEN s.code = 'VDC_001' THEN 1.8\n    END, -- average_delivery_days\n    CASE \n        WHEN s.code = 'DELL_001' THEN 248\n        WHEN s.code = 'SAB_001' THEN 156\n        WHEN s.code = 'VDC_001' THEN 89\n    END, -- total_deliveries\n    CASE \n        WHEN s.code = 'DELL_001' THEN 10\n        WHEN s.code = 'SAB_001' THEN 12\n        WHEN s.code = 'VDC_001' THEN 2\n    END, -- late_deliveries\n    CASE \n        WHEN s.code = 'DELL_001' THEN 98.5\n        WHEN s.code = 'SAB_001' THEN 96.8\n        WHEN s.code = 'VDC_001' THEN 99.1\n    END, -- quality_acceptance_rate\n    CASE \n        WHEN s.code = 'DELL_001' THEN 0.5\n        WHEN s.code = 'SAB_001' THEN 1.2\n        WHEN s.code = 'VDC_001' THEN 0.3\n    END, -- defect_rate\n    CASE \n        WHEN s.code = 'DELL_001' THEN 1.2\n        WHEN s.code = 'SAB_001' THEN 2.1\n        WHEN s.code = 'VDC_001' THEN 0.8\n    END, -- return_rate\n    CASE \n        WHEN s.code = 'DELL_001' THEN 3\n        WHEN s.code = 'SAB_001' THEN 8\n        WHEN s.code = 'VDC_001' THEN 1\n    END, -- quality_issues\n    CASE \n        WHEN s.code = 'DELL_001' THEN 28500000.00\n        WHEN s.code = 'SAB_001' THEN 15750000.00\n        WHEN s.code = 'VDC_001' THEN 8950000.00\n    END, -- total_purchase_value\n    CASE \n        WHEN s.code = 'DELL_001' THEN 115000.00\n        WHEN s.code = 'SAB_001' THEN 101000.00\n        WHEN s.code = 'VDC_001' THEN 100600.00\n    END, -- average_order_value\n    CASE \n        WHEN s.code = 'DELL_001' THEN 12.5\n        WHEN s.code = 'SAB_001' THEN 8.0\n        WHEN s.code = 'VDC_001' THEN 15.0\n    END, -- discount_rate\n    CASE \n        WHEN s.code = 'DELL_001' THEN 9.2\n        WHEN s.code = 'SAB_001' THEN 8.5\n        WHEN s.code = 'VDC_001' THEN 9.5\n    END, -- responsiveness_rating\n    CASE \n        WHEN s.code = 'DELL_001' THEN 8.8\n        WHEN s.code = 'SAB_001' THEN 8.2\n        WHEN s.code = 'VDC_001' THEN 9.1\n    END, -- communication_rating\n    CASE \n        WHEN s.code = 'DELL_001' THEN 9.0\n        WHEN s.code = 'SAB_001' THEN 7.5\n        WHEN s.code = 'VDC_001' THEN 9.3\n    END, -- innovation_rating\n    CASE \n        WHEN s.code = 'DELL_001' THEN 8.5\n        WHEN s.code = 'SAB_001' THEN 9.2\n        WHEN s.code = 'VDC_001' THEN 8.8\n    END, -- sustainability_rating\n    CASE \n        WHEN s.code = 'DELL_001' THEN 2.5\n        WHEN s.code = 'SAB_001' THEN 4.2\n        WHEN s.code = 'VDC_001' THEN 1.8\n    END, -- response_time\n    CASE \n        WHEN s.code = 'DELL_001' THEN 5.2\n        WHEN s.code = 'SAB_001' THEN 12.8\n        WHEN s.code = 'VDC_001' THEN 3.1\n    END -- lead_time_variance\nFROM supplier_ids s;