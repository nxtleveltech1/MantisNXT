# ============================================================================
# MANTISNXT PRODUCTION ENVIRONMENT CONFIGURATION
# ============================================================================
#
# ⚠️  CRITICAL SECURITY WARNING:
#
# 1. DO NOT commit this file with real values to version control
# 2. Store secrets in your deployment platform's secrets manager:
#    - Vercel: Project Settings → Environment Variables
#    - AWS: AWS Secrets Manager or Systems Manager Parameter Store
#    - Azure: Azure Key Vault
#    - GCP: Google Secret Manager
# 3. Use different secrets for each environment (dev/staging/production)
# 4. Rotate secrets every 90 days
# 5. Never share secrets via email/Slack/unencrypted channels
#
# ============================================================================
# SETUP INSTRUCTIONS
# ============================================================================
#
# 1. Generate secrets: npm run secrets:generate
# 2. Create Neon database: See docs/database/NEON_SETUP.md
# 3. Set up Redis: See docs/infrastructure/REDIS_SETUP.md
# 4. Set up Stack Auth: See docs/auth/STACK_AUTH_SETUP.md
# 5. Validate configuration: npm run env:validate
#
# ============================================================================

# ----------------------------------------------------------------------------
# DATABASE CONFIGURATION (Required)
# ----------------------------------------------------------------------------
# Neon PostgreSQL connection string with connection pooling
# Format: postgresql://[user]:[password]@[host]/[database]?sslmode=require
#
# Get from: Neon Console → Connection Details → Connection String
# See: docs/database/NEON_SETUP.md

DATABASE_URL=postgresql://username:password@ep-xxx.region.neon.tech/mantisnxt?sslmode=require

# Connection pool settings (optional, defaults shown)
DATABASE_POOL_MIN=2
DATABASE_POOL_MAX=10
DATABASE_POOL_IDLE_TIMEOUT=30000  # 30 seconds
DATABASE_CONNECTION_TIMEOUT=10000  # 10 seconds

# ----------------------------------------------------------------------------
# AUTHENTICATION - STACK AUTH (Required)
# ----------------------------------------------------------------------------
# Stack Auth API credentials for Neon Auth integration
#
# Get from: Stack Auth Console → Project Settings → API Keys
# See: docs/auth/STACK_AUTH_SETUP.md

STACK_AUTH_PROJECT_ID=
STACK_AUTH_API_KEY=
STACK_AUTH_PUBLISHABLE_KEY=

# Stack Auth configuration
STACK_AUTH_CALLBACK_URL=https://your-domain.com/api/auth/callback
STACK_AUTH_SIGN_IN_URL=https://your-domain.com/sign-in
STACK_AUTH_SIGN_UP_URL=https://your-domain.com/sign-up

# ----------------------------------------------------------------------------
# NEXTAUTH CONFIGURATION (Required)
# ----------------------------------------------------------------------------
# NextAuth.js configuration for session management
#
# Generate with: npm run secrets:generate

NEXTAUTH_URL=https://your-domain.com
NEXTAUTH_SECRET=<generate-with-npm-run-secrets:generate>

# ----------------------------------------------------------------------------
# JWT CONFIGURATION (Required)
# ----------------------------------------------------------------------------
# JWT secret for signing authentication tokens
#
# Generate with: npm run secrets:generate

JWT_SECRET=<generate-with-npm-run-secrets:generate>
JWT_EXPIRES_IN=24h  # Token expiration (24 hours)

# ----------------------------------------------------------------------------
# SESSION CONFIGURATION (Required)
# ----------------------------------------------------------------------------
# Session encryption and management
#
# Generate with: npm run secrets:generate

SESSION_SECRET=<generate-with-npm-run-secrets:generate>
SESSION_TTL=86400  # Session lifetime in seconds (24 hours)
SESSION_PREFIX=mantis:session:  # Redis key prefix for sessions

# ----------------------------------------------------------------------------
# PII ENCRYPTION (Required - POPIA Compliance)
# ----------------------------------------------------------------------------
# AES-256-GCM encryption for sensitive personal information
# Used to encrypt SA ID numbers, financial data, etc.
#
# Generate with: npm run secrets:generate

PII_ENCRYPTION_KEY=<generate-with-npm-run-secrets:generate>
PII_ENCRYPTION_SALT=<generate-with-npm-run-secrets:generate>

# ----------------------------------------------------------------------------
# 2FA / TOTP ENCRYPTION (Required)
# ----------------------------------------------------------------------------
# Encryption for TOTP 2FA secrets stored in database
#
# Generate with: npm run secrets:generate

TOTP_ENCRYPTION_KEY=<generate-with-npm-run-secrets:generate>

# ----------------------------------------------------------------------------
# REDIS CONFIGURATION (Required)
# ----------------------------------------------------------------------------
# Redis connection for sessions, caching, and rate limiting
#
# Get from: Upstash Console / ElastiCache / Redis Cloud
# See: docs/infrastructure/REDIS_SETUP.md

REDIS_URL=redis://default:password@hostname:6379
REDIS_TLS=true  # Use TLS/SSL (required for production)

# Redis configuration (optional)
REDIS_MAX_RETRIES=3
REDIS_SOCKET_TIMEOUT=5000
REDIS_COMMAND_TIMEOUT=5000
REDIS_CONNECT_TIMEOUT=10000

# ----------------------------------------------------------------------------
# RATE LIMITING (Optional - Defaults Provided)
# ----------------------------------------------------------------------------
# Rate limiting configuration for API endpoints

RATE_LIMIT_WINDOW=60  # Window in seconds
RATE_LIMIT_MAX_REQUESTS=100  # Max requests per window

# Per-endpoint rate limits
RATE_LIMIT_AUTH=5  # 5 requests/min for auth endpoints
RATE_LIMIT_API=100  # 100 requests/min for API
RATE_LIMIT_UPLOAD=10  # 10 uploads/min
RATE_LIMIT_SENSITIVE=20  # 20 requests/min for sensitive ops

# ----------------------------------------------------------------------------
# APPLICATION CONFIGURATION (Required)
# ----------------------------------------------------------------------------

# Application environment
NODE_ENV=production

# Application URL (for callbacks, emails, etc.)
NEXT_PUBLIC_APP_URL=https://your-domain.com

# API Base URL (if different from app URL)
NEXT_PUBLIC_API_URL=https://api.your-domain.com

# Application name and metadata
NEXT_PUBLIC_APP_NAME=MantisNXT
NEXT_PUBLIC_APP_DESCRIPTION=Procurement Intelligence Platform

# ----------------------------------------------------------------------------
# EMAIL CONFIGURATION (Optional but Recommended)
# ----------------------------------------------------------------------------
# Email service for notifications, password resets, etc.
# Supports: SendGrid, AWS SES, Postmark, SMTP

# SendGrid (recommended)
EMAIL_PROVIDER=sendgrid
SENDGRID_API_KEY=
SENDGRID_FROM_EMAIL=noreply@your-domain.com
SENDGRID_FROM_NAME=MantisNXT

# AWS SES (alternative)
# EMAIL_PROVIDER=ses
# AWS_SES_REGION=us-east-1
# AWS_SES_FROM_EMAIL=noreply@your-domain.com
# AWS_ACCESS_KEY_ID=
# AWS_SECRET_ACCESS_KEY=

# SMTP (fallback)
# EMAIL_PROVIDER=smtp
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_USER=
# SMTP_PASSWORD=
# SMTP_FROM_EMAIL=noreply@your-domain.com

# ----------------------------------------------------------------------------
# WEBHOOK CONFIGURATION (Optional)
# ----------------------------------------------------------------------------
# Webhook signing and validation
#
# Generate with: npm run secrets:generate

WEBHOOK_SIGNING_SECRET=<generate-with-npm-run-secrets:generate>

# ----------------------------------------------------------------------------
# THIRD-PARTY INTEGRATIONS (Optional)
# ----------------------------------------------------------------------------

# Supabase (if using Supabase features)
NEXT_PUBLIC_SUPABASE_URL=
NEXT_PUBLIC_SUPABASE_ANON_KEY=
SUPABASE_SERVICE_ROLE_KEY=

# Analytics (Google Analytics, Plausible, etc.)
NEXT_PUBLIC_GA_TRACKING_ID=
# or
NEXT_PUBLIC_PLAUSIBLE_DOMAIN=

# Error Tracking (Sentry)
SENTRY_DSN=
SENTRY_AUTH_TOKEN=
NEXT_PUBLIC_SENTRY_DSN=

# Feature Flags (LaunchDarkly, etc.)
LAUNCHDARKLY_SDK_KEY=
NEXT_PUBLIC_LAUNCHDARKLY_CLIENT_ID=

# ----------------------------------------------------------------------------
# MONITORING AND LOGGING (Recommended)
# ----------------------------------------------------------------------------

# DataDog APM
DD_API_KEY=
DD_APP_KEY=
DD_SITE=datadoghq.com
DD_SERVICE=mantisnxt
DD_ENV=production
DD_VERSION=1.0.0

# or New Relic
# NEW_RELIC_LICENSE_KEY=
# NEW_RELIC_APP_NAME=MantisNXT

# Log Level
LOG_LEVEL=info  # debug, info, warn, error

# ----------------------------------------------------------------------------
# ALERTS AND NOTIFICATIONS (Recommended)
# ----------------------------------------------------------------------------

# Slack webhooks for production alerts
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/xxx/yyy/zzz
SLACK_ALERTS_CHANNEL=#production-alerts
SLACK_ERRORS_CHANNEL=#production-errors

# PagerDuty (for critical alerts)
PAGERDUTY_INTEGRATION_KEY=
PAGERDUTY_SERVICE_ID=

# ----------------------------------------------------------------------------
# FILE STORAGE (Optional)
# ----------------------------------------------------------------------------

# AWS S3
AWS_S3_BUCKET=mantisnxt-production
AWS_S3_REGION=us-east-1
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=

# or Cloudflare R2
# CLOUDFLARE_R2_ACCOUNT_ID=
# CLOUDFLARE_R2_ACCESS_KEY_ID=
# CLOUDFLARE_R2_SECRET_ACCESS_KEY=
# CLOUDFLARE_R2_BUCKET=

# ----------------------------------------------------------------------------
# CDN CONFIGURATION (Optional)
# ----------------------------------------------------------------------------

# Cloudflare
CLOUDFLARE_ZONE_ID=
CLOUDFLARE_API_TOKEN=

# ----------------------------------------------------------------------------
# BACKUP CONFIGURATION (Recommended)
# ----------------------------------------------------------------------------

# Backup retention (days)
BACKUP_RETENTION_DAYS=30

# Backup encryption
BACKUP_ENCRYPTION_KEY=<generate-with-npm-run-secrets:generate>

# ----------------------------------------------------------------------------
# FEATURE FLAGS (Optional)
# ----------------------------------------------------------------------------

# Enable/disable features
FEATURE_AI_INSIGHTS=true
FEATURE_SUPPLIER_DISCOVERY=true
FEATURE_LOYALTY_PROGRAM=true
FEATURE_WOOCOMMERCE_INTEGRATION=true
FEATURE_ADVANCED_ANALYTICS=true

# ----------------------------------------------------------------------------
# PERFORMANCE TUNING (Optional)
# ----------------------------------------------------------------------------

# Next.js configuration
NEXT_TELEMETRY_DISABLED=1  # Disable Next.js telemetry

# Memory limits (MB)
NODE_OPTIONS=--max-old-space-size=4096

# Cache TTL (seconds)
CACHE_TTL_SHORT=300     # 5 minutes
CACHE_TTL_MEDIUM=3600   # 1 hour
CACHE_TTL_LONG=86400    # 24 hours

# ----------------------------------------------------------------------------
# SECURITY HEADERS (Optional - Defaults Provided)
# ----------------------------------------------------------------------------

# Content Security Policy
CSP_REPORT_URI=https://your-domain.com/api/csp-report

# CORS allowed origins (comma-separated)
CORS_ALLOWED_ORIGINS=https://your-domain.com,https://www.your-domain.com

# ----------------------------------------------------------------------------
# COMPLIANCE (POPIA / GDPR)
# ----------------------------------------------------------------------------

# Data Protection Officer contact
DPO_NAME=
DPO_EMAIL=
DPO_PHONE=

# Privacy Policy / Terms URLs
NEXT_PUBLIC_PRIVACY_POLICY_URL=https://your-domain.com/privacy
NEXT_PUBLIC_TERMS_URL=https://your-domain.com/terms

# Data retention (days)
DATA_RETENTION_DAYS=2555  # 7 years (POPIA requirement)
AUDIT_LOG_RETENTION_DAYS=2555  # 7 years

# ----------------------------------------------------------------------------
# DEPLOYMENT CONFIGURATION
# ----------------------------------------------------------------------------

# Deployment platform
DEPLOYMENT_PLATFORM=vercel  # vercel, aws, azure, gcp

# Vercel-specific
VERCEL_URL=
VERCEL_ENV=production
VERCEL_GIT_COMMIT_SHA=

# Health check configuration
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PATH=/api/health

# ----------------------------------------------------------------------------
# VALIDATION
# ----------------------------------------------------------------------------
# After configuring, validate with:
#   npm run env:validate
#
# This will check:
# - All required variables are set
# - Secret strength meets minimum requirements
# - Connection strings are valid
# - External services are reachable
# ============================================================================
